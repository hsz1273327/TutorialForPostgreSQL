# 丰富的索引类型

索引是用来加快表查找速度的对象,它必须依赖表和字段,使用`CREATE INDEX {index_name} ON {table_name} [USING {index_type}] ({字段名}[,{字段名}])`语法创建.

pg提供了多种索引类型:

+ `B-tree`可以在可排序数据上的处理等值和范围查询.特别地pg的查询规划器会在任何一种涉及到以下操作符的已索引列上考虑使用B-tree索引:

    + `<`
    + `<=`
    + `=`
    + `>=`
    + `>`
    + 将上述操作符组合起来的操作,例如`BETWEEN`和`IN`
    + `IS NULL`或`IS NOT NULL`判断操作
    + `like`和`~`等在模式是一个常量且被固定在字符串的开头时
    
    B-tree索引也可以用于检索排序数据.这并不会总是比简单扫描和排序更快但是总是有用的
    
+ `Hash`只能处理简单等值比较

+ `GiST`二维几何图形信息的基础索引.可以使用基本的[二维几何图形操作符](http://www.postgres.cn/docs/11/functions-geometry.html),如:

    + `<<`
    + `&<`
    + `&>`
    + `>>`
    + `<<|`
    + `&<|`
    + `|&>`
    + `|>>`
    + `@>`
    + `<@`
    + `~=`
    + `&&`

    同时也有能力优化最近邻搜索
 

+ `SP-GiST`,和GiST相似,`SP-GiST`索引为支持多种搜索提供了一种基础结构.`SP-GiST`允许实现众多不同的非平衡的基于磁盘的数据结构例如四叉树,k-d树和radix树,比如下面的操作符:

    + `<<`
    + `>>`
    + `~=`
    + `<@`
    + `<^`
    + `>^`
    
+ `GIN`,`倒排索引`,它适合于包含多个组成值的数据值,例如数组.倒排索引中为每一个组成值都包含一个单独的项,它可以高效地处理测试指定组成值是否存在的查询.`GIN`可以用于支持数组使用下列操作符的索引化[查询](http://www.postgres.cn/docs/11/functions-array.html)：

    + `<@`
    + `@>`
    + `=`
    + `&&`

+ `BRIN`块范围索引,存储有关存放在一个表的连续物理块范围上的值摘要信息.对于具有线性排序顺序的数据类型,被索引的数据对应于每个块范围的列中值的最小值和最大值,`BRIN`支持的操作符可以在[http://www.postgres.cn/docs/11/brin-builtin-opclasses.html#BRIN-BUILTIN-OPCLASSES-TABLE]查看

每一种索引类型使用了 一种不同的算法来适应不同类型的查询.默认情况下`CREATE INDEX`命令创建适合于大部分情况的`B-tree`索引.

`B-tree`,`GiST`,`GIN`和`BRIN`支持多列索引,最多可以指定32个列.一个B-tree索引可以用于条件中涉及到任意索引列子集的查询,但是当先导列(即最左边的那些列)上有约束条件时索引最为有效;一个GIN索引可以用于条件中涉及到任意索引列子集的查询.GIN的搜索效率与查询条件中使用哪些索引列无关;多列`BRIN`索引可以被用于涉及该索引被索引列的任意子集的查询条件.同样索引搜索效率与查询条件使用哪个索引列无关.
